<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Pablo Reyes</title>
</head>

<body>
    <div id="container">
        <header id="main-header">
    <h1><a href="/">Pablo Reyes</a></h1>
    <h2>Personal Website</h2>
</header>        

        <aside id="sidebar">
    <section id="sidebar-picture">
        <img src="/images/me.jpg" />
    </section>

    <section id="about">
        <a href="http://es.linkedin.com/in/pabloreyesalmagro" style="text-decoration:none;"><span style="font: 80% Arial,sans-serif; color:#0783B6;"><img src="https://static.licdn.com/scds/common/u/img/webpromo/btn_in_20x15.png" width="20" height="15" alt="View Pablo Reyes Almagro's LinkedIn profile" style="vertical-align:middle;" border="0"></span></a>
    </section>

    <section id="last-posts">
        <h3>Latest posts</h3>
        <ul>
            
                <li><a href="/blog/stealing-info">Being a good guy, but also stealing personal info</a></li>
            
                <li><a href="/blog/hands-dirty">A curious guy getting hands dirty</a></li>
            
        </ul>
    </section>
</aside>

        <section class="content" id="main">
            <div id="paginator">
    
            <a href="/blog/hands-dirty">
            &laquo; A curious guy getting hands dirty</a>
    

    

    <hr>
</div>

<!-- Show last 5 posts here -->

<article class="post">
    <header>
        <h2><a href="/blog/stealing-info">Being a good guy, but also stealing personal info</a></h2>
        <span class="date"><i class="icon-clock"></i><time datetime="2012-10-05">Oct 05, 2012</time></span><br/>
        <span class="category"><i class="icon-tag"></i> </span><br/>
        <span class="author"><i class="icon-user"></i> </span>
    </header>

    <div class="entry"><p>As I told you the other day, some years ago <a href="/blog/hands-dirty">I did some bad things related to personal info</a>, passwords and mails. Well, I didn’t do anything wrong with that info, just obtaining it. The feeling after getting all that private, secure, illegal data gave me so much adrenaline I couldn’t stop laughing. I never told anyone about what I did, since I was really scared of what I had done and all the sensible information I had.</p>

<p>One or two years later, in 2006, I was restyling my personal blog when I found something curious. There was a public directory /wp-content/backups that had two backups of my blog database! How could that be possible? I was using the famous <a href="http://wordpress.org/extend/plugins/wp-db-backup/">wp-db-backup</a>, like many people back then. The plugin required you to give read-write permission to the wp-content/backup directory, only while making the backup. Then, you should restore its defaults permissions. I totally forgot the restore the permission after doing the backups, and I suppoused I wasn’t the only one.</p>

<p>I started a search for other famous blogs using wordpress, trying to get into their wp-content/backups directory. In 5 minutes I had found a couple of well known blogs with the same problem. I could have just mailed him telling them the problem, but I wanted to know if I was able to enter in their control panel. Yeah, bad thing again, I know…</p>

<p>I downloaded their databases backups and looked for the wp_users table, obviously. Most of the times, there was only one or two users, and one of them was admin. The passwords were encrypted in MD5, so I used the same technic as the last time. When it didn’t work, I gave <a href="http://www.openwall.com/john/">John The Ripper</a> a try. I got into a couple of admin panels and made screenshots of it, nothing else.</p>

<p>Then, instead of notifying the admins of each blog, I thought I could get some more vulnerable sites… I found a list of wordpress blogs and made the following script:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">httplib</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">urlparse</span>
 
<span class="k">def</span> <span class="nf">get_page</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPConnection</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
  <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span>
  <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
 
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="n">vulnerable</span> <span class="o">=</span><span class="p">[]</span>
  <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">&quot;http://vulnerableblog1.com/&quot;</span><span class="p">,</span>
      <span class="s">&quot;http://vulnerableblog2.com/&quot;</span><span class="p">,</span>
      <span class="s">&quot;http://vulnerableblog3.com/&quot;</span><span class="p">,</span>
      <span class="s">&quot;http://vulnerableblog4.com/&quot;</span><span class="p">,</span>
      <span class="o">...</span><span class="p">]</span>
 
  <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;Checking </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">url</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">get_page</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s">&quot;wp-content/backup/&quot;</span><span class="p">)</span>
      <span class="n">vulnerable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s">&quot;wp-content/backup&quot;</span><span class="p">)</span>
 
    <span class="k">except</span><span class="p">:</span> <span class="k">continue</span>
 
  <span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Vulnerable sites:</span><span class="se">\n</span><span class="s">&quot;</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vulnerable</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">i</span>
 
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="n">main</span><span class="p">()</span></code></pre></div>

<p>Again, a shitty script that made the job. I got a list of hundreds of vulnerable sites, from which I could get their databases and enter in their admin panel.</p>

<p>I thought that was more than enough, and I started mailing all the admins of vulnerable sites explaining what I have done, how, why, and how to solve it. I also sent screenshots of their admin panels (not everyone). I also asked each one if it was ok for them to me mentioned in a blog post I was going to write.</p>

<p>After receiving many thanks from all the site admins I wrote the <a href="http://web.archive.org/web/20070508212447/http://tronfi.com/2006/05/12/seguridad-en-blogs-o-como-consegui-entrar-en-paneles-de-administracion/">most viewed post of my old blog</a>. My post was shared in some of the most important sites of the spanish web (<a href="http://www.microsiervos.com/archivo/seguridad/seguridad-wordpress-wpdbbackup.html">Microsiervos</a>, <a href="http://curiosoperoinutil.com/2006/05/13/agujero-de-seguridad-en-blogs-de-wordpress/">CPI</a>, <a href="http://www.meneame.net/story/seguridad-en-blogs-o-como-consegui-entrar-en-paneles-de-administracion/best-comments">Meneame</a>, <a href="http://www.htmllife.com/archivos/un-despiste/">htmllife</a>, <a href="http://web.archive.org/web/20070514233249/http://www.lamateporunyogur.net/archivos/2006/05/12/cuidado-con-los-backups-de-wordpress/">La maté por un yogur</a>, anieto2k, Clarin newspaper, etc). I received many acknowledgements via mails, comments, blog posts, etc. I felt important again, but this time, people knew what I have done, and they thanked me for that. I felt that thing again, <a href="http://pabloreyes.es/blog/a-curious-guy-getting-hands-dirty/">just like the year before</a>. And now I could tell the people about that.</p>

<p>Programming is great in many senses. It opens your mind, it requires you to think in ways you never thought, it makes your boring time entertaining, but the most important thing is it gives you satisfaction. The satisfaction of a thing well done (or al least done). It doesn’t matter if it’s going to be relevant to someone else, but it is for you.</p>
</div>
</article>


        </section>
    </div>
</body>
</html>